"0","trade_data <- WITS_Partner_Timeseries %>% select(-""Partner Name"", -""Trade Flow"", -""Indicator"")"
"0","trade_data <- pivot_longer(trade_data, "
"0","                          cols = c(""2002"",        "
"0","                                   ""2003"",          ""2004"",          ""2005"",         ""2006"",         ""2007"",         "
"0","                                   ""2008"",          ""2009"" ,         ""2010"" ,         ""2011"",          ""2012"",         "
"0","                                   ""2013"",          ""2014"",          ""2015"",          ""2016"",          ""2017"",         "
"0","                                   ""2018"" ,         ""2019"",          ""2020""         ), "
"0","                          names_to = ""Year"", "
"0","                          values_to = ""Share"")"
"0","trade_data <- trade_data %>% mutate(cty_name = countrycode(trade_data$`Reporter Name`, ""country.name"", ""cown""))"
"0","trade_data <- trade_data %>% mutate(Year = as.numeric(Year))"
"0","##############"
"0","China_post12 <- dfAgree %>% filter(year >= 2002 & ccode1 == 710) %>% mutate(cty_name = countrycode(ccode2, ""cown"", ""country.name""))"
"0",""
"0",""
"0","###########"
"0","combined <- left_join(China_post12, trade_data, by = c(""ccode2"" = ""cty_name"", ""year"" = ""Year"")) %>% "
"0","  mutate(Share = Share / 100)"
"0",""
"0","plot_time_series <- function(data, country_code, title, vline_years = NULL) {"
"0","  # Start the ggplot"
"0","  p <- ggplot(data %>% filter(ccode2 == country_code), aes(x = year)) +"
"0","    geom_line(aes(y = agree, color = ""agree"")) +"
"0","    geom_line(aes(y = Share, color = ""Share"")) +"
"0","    scale_color_manual(values = c(""agree"" = ""blue"", ""Share"" = ""red"")) +"
"0","    labs(title = title,"
"0","         x = ""Year"","
"0","         y = ""Value"","
"0","         color = ""Legend"")"
"0",""
"0","  # Add vertical lines only if vline_years is provided"
"0","  if (!is.null(vline_years) && length(vline_years) > 0) {"
"0","    p <- p + geom_vline(xintercept = vline_years, linetype = ""dashed"", color = ""black"")"
"0","  }"
"0",""
"0","  return(p)"
"0","}"
"0",""
"0",""
